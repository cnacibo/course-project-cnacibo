# Приёмка в формате Gherkin

Feature: Авторизация владельца карточки

  Scenario: Пользователь может редактировать только свои карточки
    Given пользователь "user1" аутентифицирован с токеном "token1"
    And существует карточка с id "card123" принадлежащая "user2"
    When "user1" отправляет PATCH /cards/card123 с новым заголовком
    Then ответ должен быть 403 Forbidden
    And в теле ответа должна быть ошибка "Access denied"

  Scenario: Владелец успешно редактирует свою карточку
    Given пользователь "user1" аутентифицирован с токеном "token1"
    And существует карточка с id "card123" принадлежащая "user1"
    When "user1" отправляет PATCH /cards/card123 с title="Новое название"
    Then ответ должен быть 200 OK
    And карточка должна быть обновлена

Feature: Валидация перемещения карточек

  Scenario: Успешное перемещение между разрешенными колонками
    Given карточка находится в колонке "todo"
    When пользователь перемещает карточку в колонку "in-progress"
    Then операция должна завершиться успешно
    And карточка должна быть в колонке "in-progress"

  Scenario: Неудачное перемещение в несуществующую колонку
    Given карточка находится в колонке "todo"
    When пользователь перемещает карточку в колонку "invalid-column"
    Then ответ должен быть 422 Unprocessable Entity
    And в ответе должна быть ошибка валидации

Feature: Защита от перебора паролей

  Scenario: Блокировка при множественных неудачных попытках входа
    Given пользователь "testuser" существует в системе
    When происходит 5 неудачных попыток входа за 1 минуту
    Then следующие попытки входа должны возвращать 429 Too Many Requests
    And в логах должно быть записано событие "rate_limit_exceeded"

  Scenario: Успешный вход после блокировки по истечении времени
    Given пользователь был временно заблокирован из-за частых запросов
    When прошло 2 минуты с момента блокировки
    Then следующая успешная попытка входа должна быть разрешена
